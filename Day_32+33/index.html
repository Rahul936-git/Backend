<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket and Socket.io part 2</title>
</head>
<body style="display: flex; justify-content: center; align-items: center;background-color: black; color: white;">

    <div>
        <h1 style="text-align: center;">Chat App</h1>
        <input type="number" placeholder="Enter your room number" id="room_number" style=" text-align: center; margin-left: 16vw; padding: 5px; margin-top:2px;margin-bottom: 10px; background-color:whitesmoke ;color:black; border-radius: 5px; ">
        <button onclick="joinRoom()">join</button>
        <div id="messageBox" style="height: 50vh; width: 50vw; padding:30px; font-size: larger; background-color: grey;color: white; border: 2px solid black; border-radius: 20px;"></div>
        <input type="text" placeholder="type your message here" id="messageInput" style=" text-align: center; margin-left: 16vw; padding: 5px; margin-top: 12px; background-color:whitesmoke ;color:black; border-radius: 5px; ">
        <button onclick="sendMessage()">Send</button>
    </div>

    <!-- <script src="/socket.io/socket.io.js"></script>
    <script>
    const socket = io();
    </script> -->

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        // console.log(socket);
        // console.log(socket.id);    // it take some time to connect but default it is undefined
        // socket.on('connect',()=>{
        //     console.log(socket.id);   // now it connected to socket
        // })

    const messageBox = document.getElementById('messageBox');
    const messageInput = document.getElementById('messageInput');
    const room_number = document.getElementById('room_number');

    let roomId =null;

    // function sendMessage(){
    //     const msg = messageInput.value;
    //     socket.emit('message',msg);
    //     messageInput.value="";
    // }

    // socket.on("new-message",(data)=>{
    //     const element = document.createElement('div');
    //     element.innerText = data;    // innerContent
    //     messageBox.appendChild(element);
    // })

// // ////////////////////////////// display message in left rifght formate

    function sendMessage(){
        const msg = messageInput.value;
        // socket.emit('message',msg);
        socket.emit('message',{room:roomId,msg:msg});  // msg:msg === msg

        const element = document.createElement('div');
        element.innerText = msg;    // innerContent
        element.style.textAlign='right';
        messageBox.appendChild(element);

        messageInput.value="";
    }

    function joinRoom(){
        const room = room_number.value;
        roomId = room;
        socket.emit('join_room',room);
    }

    socket.on("new-message",(data)=>{
        const element = document.createElement('div');
        element.innerText = data;    // innerContent
        messageBox.appendChild(element);
    })

    </script>
</body>
</html>